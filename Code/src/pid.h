#ifndef PID_H
#define PID_H
//
//

// Constants
// IR_OUT:
// 1 - left
// 2 - front left
// 3 - front right
// 4 - right

#include "mouse.h"
#define RIGHT_THRESHOLD 210
#define LEFT_THRESHOLD 170

#define TARGET 4.1 // the actual distance

//#define KP 0.00095
//#define KD 0.215
//#define ADJUST 100

// PID CONSTANTS
#define KP 1
#define KD 0
#define ADJUST 1

#define LEFT_MAX_SPEED 200
#define RIGHT_MAX_SPEED 200

#ifndef HIGH
#define HIGH 1
#endif

#ifndef LOW
#define LOW 0
#endif

// FOR MAPPING SENSOR READINGS
#define IN_MIN 0
#define IN_MAX 1600
#define OUT_MAX 255
#define RATIO OUT_MAX/IN_MAX

/*****************************************************************************/
// Sensor-Distance Hashtable
/*****************************************************************************/
float distance_RF[256] = {
	/* 0 ~ 7 */ 
	10.84270965,10.71453745,10.58788038,10.46272053,10.3390402,10.2168219,10.09604835,
	9.976702471,9.858767385,9.742226415,9.627063082,9.5132611,9.40080437,9.28967701,
	9.17986328,9.07134767,8.964114832,8.858149593,8.753436975,8.64996217,8.547710546,
	8.446667643,8.346819173,8.248151017,8.150649222,8.0543,7.959089728,7.86500494,
	7.772032333,7.68015876,7.589371229,7.499656902,7.411003093,7.323397264,7.236827028,
	7.151280143,7.066744512,6.983208181,6.900659337,6.819086306,6.738477555,6.658821683,
	6.580107428,6.502323657,6.425459372,6.349503704,6.274445911,6.20027538,6.126981623,
	6.054554275,5.982983093,5.912257959,5.842368869,5.773305942,5.705059411,5.637619626,
	5.57097705,5.505122259,5.44004594,5.375738892,5.312192021,5.24939634,5.18734297,
	5.126023136,5.065428167,5.005549493,4.946378649,4.887907266,4.830127076,4.773029908,
	4.716607689,4.66085244,4.605756276,4.551311407,4.497510133,4.444344846,4.391808029,
	4.339892253,4.288590175,4.237894541,4.187798183,4.138294017,4.089375042,4.04103434,
	3.993265076,3.946060495,3.899413922,3.85331876,3.807768491,3.762756674,3.718276944,
	3.674323011,3.63088866,3.587967748,3.545554206,3.503642037,3.462225314,3.42129818,
	3.380854847,3.340889598,3.301396779,3.262370807,3.223806162,3.185697393,3.148039108,
	3.110825985,3.074052759,3.037714232,3.001805264,2.966320778,2.931255755,2.896605238,
	2.862364326,2.828528178,2.795092009,2.76205109,2.729400749,2.69713637,2.66525339,
	2.633747299,2.602613644,2.571848021,2.541446081,2.511403523,2.481716099,2.452379612,
	2.423389913,2.394742903,2.366434531,2.338460793,2.310817734,2.283501445,2.256508063,
	2.229833771,2.203474797,2.177427414,2.151687939,2.126252731,2.101118194,2.076280773,
	2.051736957,2.027483274,2.003516296,1.979832632,1.956428934,1.933301892,1.910448236,
	1.887864735,1.865548194,1.843495458,1.821703408,1.800168963,1.778889078,1.757860744,
	1.737080986,1.716546867,1.696255483,1.676203964,1.656389476,1.636809215,1.617460413,
	1.598340335,1.579446276,1.560775565,1.542325561,1.524093655,1.50607727,1.488273857,
	1.470680899,1.453295908,1.436116427,1.419140024,1.402364301,1.385786884,1.36940543,
	1.353217622,1.33722117,1.321413814,1.305793317,1.29035747,1.275104092,1.260031024,
	1.245136136,1.230417321,1.215872498,1.20149961,1.187296624,1.173261533,1.159392351,
	1.145687118,1.132143895,1.118760766,1.105535841,1.092467248,1.079553139,1.066791689,
	1.054181093,1.041719566,1.029405349,1.017236698,1.005211893,0.993329235,0.981587041,
	0.969983653,0.958517429,0.947186748,0.935990007,0.924925624,0.913992033,0.903187688,
	0.892511063,0.881960646,0.871534946,0.861232489,0.851051818,0.840991493,0.831050091,
	0.821226208,0.811518453,0.801925454,0.792445854,0.783078313,0.773821506,0.764674124,
	0.755634874,0.746702477,0.737875671,0.729153207,0.720533851,0.712016385,0.703599605,
	0.69528232,0.687063354,0.678941544,0.670915743,0.662984815,0.65514764,0.647403107,
	0.639750124,0.632187606,0.624714486,0.617329705,0.610032221,0.602821,0.595695024,
	0.588653284,0.581694785,0.574818542,0.568023584,0.56130895,0.554673689,0.548116865,
	0.541637549,0.535234825,0.528907788,0.522655543
};

float distance_LF[256] = {
	/* 0 ~ 10 */
	8.946258778,8.837175977,8.729423235,8.622984336,8.517843259,8.413984179,8.311391466,
	8.210049678,8.109943562,8.011058053,7.913378266,7.8168895,7.721577233,7.627427121,
	7.534424991,7.442556848,7.351808864,7.262167381,7.173618908,7.086150116,6.999747842,
	6.914399081,6.830090988,6.746810874,6.664546203,6.583284596,6.503013821,6.423721798,
	6.345396591,6.268026413,6.191599619,6.116104706,6.041530311,5.967865211,5.895098318,
	5.823218681,5.752215481,5.682078031,5.612795775,5.544358286,5.476755264,5.409976534,
	5.344012044,5.278851867,5.214486197,5.150905344,5.08809974,5.026059933,4.964776584,
	4.904240471,4.844442482,4.785373616,4.727024985,4.669387805,4.612453402,4.556213207,
	4.500658756,4.445781686,4.39157374,4.338026757,4.285132679,4.232883545,4.181271491,
	4.130288748,4.079927645,4.0301806,3.981040127,3.932498829,3.884549402,3.837184627,
	3.790397377,3.74418061,3.698527369,3.653430783,3.608884065,3.564880511,3.521413498,
	3.478476483,3.436063004,3.394166677,3.352781198,3.311900337,3.271517941,3.231627932,
	3.192224307,3.153301135,3.114852558,3.076872789,3.039356112,3.00229688,2.965689516,
	2.92952851,2.893808419,2.858523867,2.823669545,2.789240205,2.755230666,2.72163581,
	2.68845058,2.655669981,2.62328908,2.591303003,2.559706936,2.528496124,2.497665869,
	2.467211531,2.437128526,2.407412327,2.378058462,2.349062511,2.320420111,2.292126952,
	2.264178774,2.236571372,2.209300591,2.182362325,2.155752521,2.129467173,2.103502326,
	2.077854071,2.052518548,2.027491944,2.002770493,1.978350473,1.95422821,1.930400072,
	1.906862474,1.883611872,1.860644768,1.837957704,1.815547266,1.793410082,1.771542819,
	1.749942186,1.728604932,1.707527845,1.686707755,1.666141526,1.645826063,1.62575831,
	1.605935244,1.586353884,1.567011282,1.547904527,1.529030742,1.510387088,1.491970758,
	1.47377898,1.455809017,1.438058164,1.420523749,1.403203134,1.38609371,1.369192904,
	1.352498172,1.336007,1.319716907,1.303625442,1.287730181,1.272028733,1.256518735,
	1.241197852,1.226063779,1.211114237,1.196346976,1.181759775,1.167350437,1.153116793,
	1.139056703,1.125168048,1.11144874,1.097896713,1.084509927,1.071286368,1.058224046,
	1.045320994,1.03257527,1.019984957,1.007548158,0.995263003,0.983127643,0.97114025,
	0.959299021,0.947602174,0.936047947,0.924634603,0.913360423,0.90222371,0.891222789,
	0.880356003,0.869621717,0.859018316,0.848544203,0.838197802,0.827977556,0.817881927,
	0.807909395,0.79805846,0.788327638,0.778715465,0.769220494,0.759841297,0.750576461,
	0.741424593,0.732384314,0.723454265,0.714633101,0.705919494,0.697312133,0.688809723,
	0.680410984,0.672114652,0.663919478,0.655824228,0.647827685,0.639928645,0.632125918,
	0.624418332,0.616804724,0.609283951,0.601854879,0.59451639,0.587267381,0.58010676,
	0.573033449,0.566046384,0.559144513,0.552326797,0.54559221,0.538939739,0.532368383,
	0.525877152,0.519465069,0.513131169,0.5068745,0.500694118,0.494589095,0.488558511,
	0.482601459,0.476717042,0.470904374,0.465162581,0.459490798,0.453888172,0.448353859,
	0.442887027,0.437486853,0.432152523,0.426883236,0.421678198,0.416536625,0.411457744,
	0.406440791,0.40148501,0.396589655,0.39175399  
};

/*****************************************************************************/
// Functions
/*****************************************************************************/
float map_RF();
float map_LF();
void pid();

#endif // PID_H

